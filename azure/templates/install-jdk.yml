parameters:
  - name: service_name
    type: string

steps:
  - bash: |
      set -e
      
      dir=$(find . -maxdepth 1 -type d -name 'personal-demographics*' | head -n 1)
      echo "Found directory: $dir"
      ls -la "$dir"

      if [ -f "$dir/Makefile" ]; then
        echo "Makefile found. Contents:"
        cat "$dir/Makefile"
      else
        echo "No Makefile found in $dir"
        exit 1
      fi
      
      cd "$dir"
      make download-openjdk
    displayName: "Download OpenJDK"

  - task: JavaToolInstaller@0
    displayName: Install JRE & JDK v20 x64
    inputs:
      versionSpec: "20"
      jdkArchitectureOption: "x64"
      jdkSourceOption: "LocalDirectory"
      jdkFile: "/tmp/openjdk.tar.gz"
      jdkDestinationDirectory: "/tmp/openjdk"