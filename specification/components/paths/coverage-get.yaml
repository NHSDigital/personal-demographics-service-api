summary: Get a patients coverage
operationId: get-coverage
description: |
  ## Overview
  Use this endpoint to get a patient's European Health Insurance Card (EHIC) details. Use the patient's NHS number as the identifier for coverage.

  This endpoint only gives EHIC data in the coverage data fields. A patient may have other financial coverage, like insurance, but this information will not be returned by PDS. 

  You can only use this endpoint if you are using patient access mode (for specific use cases only). 
    
  ## Superseded patients
  Some patients are marked as superseded. This means that the original patient details are no longer valid and have been replaced with different details.

  When PDS tries to get the EHIC details using the NHS number of a superseded record, it will return the EHIC details of the latest record. You can see this by comparing the value used in the query with the value returned in the response body.

  ## Mandatory fields
  In a coverage get request, there are two mandatory EHIC fields. They are the patient's NHS Number and the unique ID of issuer of the policy. If either of these fields on the patient's record is empty, PDS will not return the patient's EHIC information. If any other EHIC field on the patient's record is empty, PDS will return the patient's EHIC information without those fields.

  ## Sandbox test scenarios
    You can test the following scenarios in our sandbox environment:

    | Scenario                        | Request                                       | Response                                                      |
    | ------------------------------- | --------------------------------------------- | ------------------------------------------------------------- |
    | xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  | `id`=``                                       | xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx |
    | xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  | `id`=``                                       | xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx |
    | xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  | `id`=``                                       | xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx |
    | xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  | `id`=``                                       | xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx |

    You can try out the sandbox by selecting the 'Try' button on this page.

    Alternatively, you can try out the sandbox using our Postman collection:
    
    [![Run in Postman](https://run.pstmn.io/button.svg)](https://)
parameters:
  - $ref: '../../personal-demographics.yaml#/components/parameters/SubscriberIdentifier'
responses:
  '200':
    description: |
      A completed search for coverage. This will contain zero or one Coverage resources in the Bundle.

    headers:
      X-Correlation-Id:
        $ref: '../../personal-demographics.yaml#//components/headers/X-Correlation-Id'
      X-Request-Id:
        $ref: '../../personal-demographics.yaml#//components/headers/X-Request-Id'

  '4XX':
    description: |
        An error occurred as follows:

        | HTTP status | Error code                 | Description                                                                                                                                |
        | ----------- | -------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------ |
        | 400         | INVALID_RESOURCE_ID        | Invalid NHS number.
        | 400         | INVALID_SEARCH_DATA	       | Invalid combination of search parameters. For details, see the `diagnostics` field.
        | 400         | MISSING_VALUE              | Missing header or query parameter. For details, see the `diagnostics` field.
        | 400         | INVALID_VALUE              | Invalid header or query parameter. For details, see the `diagnostics` field.
        | 401         | ACCESS_DENIED     	       | Access token missing, invalid or expired, or calling application not configured for this operation.
        | 403         | ACCESS_DENIED     	       | User cannot perform this operation.
        | 404         | RESOURCE_NOT_FOUND         | Patient does not exist for given NHS number.
        | 404         | INVALIDATED_RESOURCE       | Patient did exist for given NHS number, but has been invalidated and not superseded by another NHS number.
        | 408         | UNABLE_TO_CALL_SERVICE     | The downstream domain processing has not completed within the configured timeout period.
        | 429         | TOO_MANY_REQUESTS          | You have exceeded your application's [rate limit](https://digital.nhs.uk/developer/guides-and-documentation/reference-guide#rate-limits).

    headers:
      X-Correlation-Id:
        $ref: '../../personal-demographics.yaml#//components/headers/X-Correlation-Id'
      X-Request-Id:
        $ref: '../../personal-demographics.yaml#//components/headers/X-Request-Id'

    content:
      application/fhir+json:
        schema:
          $ref: '../../personal-demographics.yaml#//components/schemas/OperationOutcome'
        example:
          resourceType: OperationOutcome
          issue:
            - severity: error
              code: forbidden
              details:
                coding:
                  - system: 'https://fhir.nhs.uk/R4/CodeSystem/Spine-ErrorOrWarningCode'
                    version: '1'
                    code: ACCESS_DENIED
                    display: Cannot GET resource with user-restricted access token
              diagnostics: "Your app has insufficient permissions to use this operation. Please contact support."